<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      /**
       * 递归求斐波那契数(chrome最小占用内存大约292字节，最大占用内存2272字节)
       * 
       * @param index 位置
       * @returns
       */
      function fibonacciRecursion(index) {
        if (index < 1) {
          return 0;
        }

        index = index | 0;
        if (index <= 2) {
          return 1;
        }

        return fibonacciRecursion(index - 1) + fibonacciRecursion(index - 2);
      }
      fibonacciRecursion(40);

      /**
       * 动态规划求斐波那契数
       * 该方法最小占用内存384字节，最大占用1380字节，chrome下
       * 使用数组变量替代数字变量保存数据后，该方法内存占用大大减少
       * @param idx 位置
       * @returns
       */
      function fibonacciIterative(idx) {
        if (idx < 1) {
          return 0;
        }

        idx = idx | 0;
        if (idx <= 2) {
          return 1;
        }

        const arr = [1, 1]
        for (let i = 3; i <= idx; i++) {
          arr.push(arr[0] + arr[1]);
          arr.shift();
        }

        return arr[1];
      }
      fibonacciIterative(1);

      /**
       * 记忆化斐波那契数(chrome最小占用内存大约656字节，最大占用内存1624字节)
       * @param n 位置
       * @returns
       */
      function fibonacciMemoization(n) {
        if (n < 1) {
          return 0;
        }

        n = n | 0;
        const arr = [0, 1];
        const fibonacci = (n) => {
          if (arr[n] != undefined) {
            return arr[n];
          }

          return (arr[n] = fibonacci(n - 1) + fibonacci(n - 2));
        };

        return fibonacci(n);
      }

      fibonacciMemoization(10);
    </script>
  </body>
</html>
